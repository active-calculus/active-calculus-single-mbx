<?xml version="1.0" encoding="UTF-8" ?>
<!-- **********************************************************************-->
<!-- Copyright 2012-2022                                                   -->
<!-- Matthew Boelkins                                                      -->
<!--                                                                       -->
<!-- This file is part of Active Calculus.                                 -->
<!--                                                                       -->
<!-- Permission is granted to copy, distribute and/or modify this document -->
<!-- under the terms of the Creative Commons BY-SA license.  The work      -->
<!-- may be used for free by any party so long as attribution is given to  -->
<!-- the author(s), the work and its derivatives are used in the spirit of -->
<!-- "share and share alike".  All trademarks are the registered marks of  -->
<!-- their respective owners.                                              -->
<!-- **********************************************************************-->
<section xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="sec-8a-1-linear-poly">
  <title>Approximating <m>f(x) = e^x</m></title>
  <objectives>
    <ul>
      <li>
        <p>
          How well does the tangent line at <m>a = 0</m> approximate the function <m>f(x) = e^x</m> near <m>a = 0</m>?
        </p>
      </li>
      <li>
        <p>
          Can we find higher degree polynomials that approximate <m>f(x) = e^x</m> near <m>a = 0</m> more effectively than the approximation generated by the tangent line?
        </p>
      </li>
      <li>
        <p>
          How does the degree of the polynomial impact the accuracy of the approximation of <m>f(x) = e^x</m>?
        </p>
      </li>
    </ul>

  </objectives>

  <introduction>
    <p>
      Early in our study of calculus in <xref ref="sec-1-8-tan-line-approx">Section</xref>, we learned that if a function <m>f</m> has a derivative at a fixed value <m>x=a</m>, when we zoom in on its graph near <m>(a,f(a))</m>, the function looks linear.  Indeed, such a function is differentiable, and we know that near a fixed input value <m>a</m>, 
      <me>
        f(x) \approx L(x) = f(a) + f’(a)(x-a),
      </me>
      where <m>L</m> is the tangent line approximation to <m>f</m> at <m>a</m>.
    </p>

    <p>
      In this section, we focus on the function <m>f(x) = e^x</m> and investigate how we can approximate its value near <m>a = 0</m> using other basic functions.
    </p>

    <xi:include href="./previews/PA-8a-1.xml" />
   
  </introduction>

  <subsection>
    <title>Finding a quadratic approximation</title>
    <!-- <idx><h>quadratic approximation</h></idx> -->
    <!-- think carefully about indexing -->

    <p>
      In <xref ref="PA-8a-1">Preview Activity</xref>, we found that the error in the tangent line approximation of <m>f(x) = e^x</m> at <m>a = 0</m> grows significantly as we consider <m>x</m>-values further and further from <m>0</m>.  This is due to the fact that the tangent line is straight while the function <m>f(x) = e^x</m> has some curvature.  So, we are going to try to find a quadratic approximation whose curvature matches that of <m>f(x) = e^x</m> at the point of tangency.
    </p>

    <p>
      While we have usually used the notation <q><m>L(x)</m></q> for the tangent line, in what follows we will instead write <q><m>T_1(x)</m></q>, and think of this as <q>the degree <m>1</m> approximation</q>.  In a similar way, we will write <m>T_2(x)</m> for the quadratic approximation.
    </p>

    <p>
      Recall that for any function <m>f</m> that has a derivative at <m>a=0</m>, its tangent line approximation at <m>a=0</m> is 
      <me>
        T_1(x) = f(0) + f’(0)(x - 0)
      </me>
      Moreover, the functions <m>T_1</m> and <m>f</m> have two exact values in common.  First, their function values agree at the point of tangency: <m>T_1(0) = f(0)</m>.  And second, since <m>T_1(x)</m> is a linear function whose slope is <m>f’(0)</m>, it is also true that their derivative values agree at the point of tangency: <m>T_1’(0) = f’(0)</m>.
    </p>

    <p>
      To generate a quadratic function that approximates <m>f</m> near <m>a = 0</m>, we choose to have this quadratic function not only share the same function value and derivative value as <m>f</m> at <m>a=0</m>, but also the same second<fn>Here we are implicitly assuming that the function <m>f(x)</m> has a second derivative at <m>a=0</m>.</fn> derivative value at <m>a=0</m>, in order to match the concavity or curvature.  In other words, we are adding a term to the linear approximation that gives the same amount of curvature as the linear function. 
    </p>

    <p>
      We can state these requirements more formally as follows:  we seek a function <m>T_2(x)</m> of the form
      <me>
        T_2(x) = c_0 + c_1 x + c_2 x^2
      </me>
      that satisfies 
      <ul>
        <li>
          <p>
            <m>T_2(0) = f(0)</m>, so <m>T_2</m> and <m>f</m> share the same height at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>T_2'(0) = f'(0)</m>, so <m>T_2</m> and <m>f</m> share the same slope at <m>a = 0</m>;
          </p>
        </li>
        <li>
          <p>
            <m>T_2''(0) = f''(0)</m>, so <m>T_2</m> and <m>f</m> share the same concavity at <m>a = 0</m>.
          </p>
        </li>
      </ul>
    </p>

    <p>
      In <xref ref="act-8a-1-1">Activity</xref>, we explore how these three requirements determine <m>c_0</m>, <m>c_1</m>, and <m>c_2</m> in <m>T_2(x)</m> for the function <m>f(x) = e^x</m>.
    </p>

    <xi:include href="./activities/act-8a-1-1.xml" />

    <p>
      While we will develop this idea more formally in <xref ref="sec-8a-2-taylor-poly">Section</xref>, the polynomial <m>T_2(x)</m> that we found in <xref ref="act-8a-1-1">Activity</xref> is called the <q>degree 2 Taylor polynomial of <m>f</m> centered at <m>a=0</m></q>.
    </p>

  </subsection>

  <subsection>
    <title>Over and over again</title>

    <p>
      A remarkable feature of mathematics is that when a process effectively generates an approximation, doing that same process again (perhaps with some slight modifications) often improves the approximation.  In <xref ref="act-8a-1-1">Activity</xref>, we found a quadratic approximation of <m>f(x)=e^x</m> near the point <m>(0,f(0))</m> that results in an improvement over the linear approximation of <m>f</m>.  It is reasonable to hope that a degree 3 polynomial approximation of <m>f(x) = e^x</m> will be even better.
    </p>

    <p>
      To investigate, we seek a degree <m>3</m> polynomial <m>T_3(x)</m> of the form
      <me>
        T_3(x) = k_0 + k_1 x + k_2 x^2 + k_3 x^3
      </me>
      that satisfies 
      <ul>
        <li>
          <p>
            <m>T_3(0) = f(0)</m>, <m>T_3'(0) = f'(0)</m>, and <m>T_3''(0) = f''(0)</m> so that <m>T_3</m> and <m>f</m> share the same function value, first derivative value, and second derivative value at <m>a = 0</m>; plus the additional condition that
          </p>
        </li>
        <li>
          <p>
            <m>T_3'''(0) = f'''(0)</m>, so <m>T_3</m> and <m>f</m> share the same third<fn>Here we are assuming that the original function <m>f</m> has a third derivative at <m>a = 0</m>.</fn> derivative value at <m>a = 0</m>.
          </p>
        </li>
      </ul>
    </p>

    <p>
      Like in our work with <m>T_2</m>, we observe that since <m>T_3</m> is a polynomial, its derivatives are straightforward to compute.  For instance, 
        <me>T_3'(x) = k_1 + 2k_2 x + 3k_3 x^2.</me>
      We continue our investigation of this new approximation of <m>f(x) = e^x</m> in <xref ref="act-8a-1-2">Activity</xref>, where we work to determine the values of <m>k_0</m>, <m>k_1</m>, <m>k_2</m>, and <m>k_3</m> plus explore how well <m>T_3(x)</m> approximates <m>f(x)</m> near <m>a = 0</m>.
    </p>  

    <xi:include href="./activities/act-8a-1-2.xml" />

    <p>
      Like in the quadratic case, we’ll call<fn>See <xref ref="def-Taylor-poly-0">Definition</xref> for the formal definition of a Taylor polynomial centered at <m>a = 0</m>.</fn> the cubic polynomial <m>T_3(x)</m> the <q>degree 3 Taylor polynomial of <m>f</m> centered at <m>a=0</m></q>.  
    </p>

  </subsection>

  <subsection>
    <title>As the degree of the approximation increases</title>
    <p>
      Our work so far suggests that, given the function <m>f(x)=e^x</m>, we can find a degree <m>n</m> polynomial approximation, <m>T_n</m>, that satisfies 
      <me>T_n(0) = f(0), T_n’(0) = f’(0), T_n’’(0) = f_n’’(0), \ldots, T_n^{(n)}(0) = f^{(n)}(0)</me>.  Moreover, since it appears that increasing the degree <m>n</m> improves the accuracy of the approximation, we now want to investigate further what happens as <m>n</m> increases.
    </p>


    <p>
      So far, we have found the following approximations for <m>f(x) = e^x</m> near <m>a = 0</m>:
      <ul>
        <li>
          <p>
            <m>T_1(x) = 1 + x</m>
          </p>
        </li>
        <li>
          <p>
            <m>T_2(x) = 1 + x + \frac{1}{2}x^2</m>
          </p>
        </li>
        <li>
          <p>
            <m>T_3(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3</m>
          </p>
        </li>
        <li>
          <p>
            <m>T_4(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3 + \frac{1}{24}x^4</m>
          </p>
        </li>
      </ul>
      In <xref ref="sec-8a-2-taylor-poly">Section</xref>, we will develop a general approach to finding the coefficient of <m>x^n</m> in the degree <m>n</m> approximation; for now, we will use the <m>4</m> functions above and study further how the accuracy of the approximation changes with the degree.
    </p>

    <xi:include href="./activities/act-8a-1-3.xml" />

  </subsection>

  <subsection>
    <title>Summary</title>
    <p>
      <ul>
      <li>
        <p>
          For the function <m>f(x) = e^x</m>, which bends considerably (especially for <m>x > 0</m>) as we move away from <m>a = 0</m>, the tangent line is not a very good approximation for <m>x</m>-values that satisfy <m>|x| > 0.5</m>.  For example, <m>|f(0.5) - e^{0.5}| = 0.148721</m>, so the linear approximation has an absolute error of more than <m>0.1</m> at <m>x = 0.5</m>.
        </p>
      </li>
      <li>
        <p>
          Using the strategy of finding a higher degree polynomial whose function and derivative values match at the selected point of tangency, we are able to find higher degree polynomials that approximate <m>f(x) = e^x</m> near <m>a = 0</m> much more effectively than the approximation generated by the tangent line.  For example, using the degree <m>3</m> approximation <m>T_3(x) = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3</m>, we see that <m>|f(x) - T_3(x)| \lt 0.01</m> for all <m>x</m> that satisfy <m>|x| \lt 0.6</m>.
        </p>
      </li>
      <li>
        <p>
          It appears that the degree of the polynomial impacts the accuracy of the approximation of <m>f(x) = e^x</m> in at least two ways:  if we fix an <m>x</m>-value, the higher the degree of the polynomial, the more accurate the approximation.  In addition, raising the degree of the polynomial approximation appears to widen the interval on which the approximation is effective.
        </p>
      </li>

      </ul>
    </p>
  </subsection>


  <xi:include href="./exercises/ez-8a-1.xml" />


</section>

